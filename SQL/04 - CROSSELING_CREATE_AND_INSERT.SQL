SET
    ANSI_NULLS ON
GO
SET
    QUOTED_IDENTIFIER ON
GO
IF  EXISTS (SELECT * FROM sys.objects WHERE object_id = OBJECT_ID(N'[dbo].[CROSSELLING]') AND type in (N'U'))
DROP TABLE [dbo].[CROSSELLING]
GO
    CREATE TABLE [dbo].[CROSSELLING](
        [PERIODO] [char](6) NOT NULL,
        [ID_USER] [char](32) NOT NULL,
        [RELACION] [char](4) NOT NULL,
        [TIPOIMPN] [char](2) NULL,
        [NATUJURI] [char](2) NULL,
        [SUCURSAL] [char](3) NULL,
        [BCRASECT] [char](11) NULL,
        [BCRASEGO] [char](1) NULL,
        [GRUPO_CLIENTE] [char](2) NULL,
        [GRUPOGENERAL] [varchar](50) NULL,
        [SUBGRUPO] [varchar](50) NULL,
        [SEGMENTO_SUELDOS] [varchar](50) NULL,
        [SEGMENTO_BANCAS] [varchar](50) NULL,
        [FUM] [date] NULL,
        [ES_CLIENTE] [smallint] NULL,
        [ES_CAPITA] [smallint] NULL,
        [CL_ACTIVO_FUM] [smallint] NULL,
        [TIENE_I_CA_D] [smallint] NULL,
        [TIENE_I_CA_P] [smallint] NULL,
        [TIENE_I_CBESA] [smallint] NULL,
        [TIENE_I_CC] [smallint] NULL,
        [TIENE_I_CCAD] [smallint] NULL,
        [TIENE_I_CS] [smallint] NULL,
        [TIENE_I_FCI] [smallint] NULL,
        [TIENE_I_PF] [smallint] NULL,
        [TIENE_I_PR_HIP] [smallint] NULL,
        [TIENE_I_PR_PERS] [smallint] NULL,
        [TIENE_I_PREP] [smallint] NULL,
        [TIENE_I_SE_PATR] [smallint] NULL,
        [TIENE_I_SEG_VIDA] [smallint] NULL,
        [TIENE_I_VISA] [smallint] NULL,
        [TIENE_I_TJ_SOC] [smallint] NULL,
        [TIENE_E_AC_CC] [smallint] NULL,
        [TIENE_E_CC] [smallint] NULL,
        [TIENE_E_CONV_AH] [smallint] NULL,
        [TIENE_E_CONV_COMALI] [smallint] NULL,
        [TIENE_E_CONV_PP] [smallint] NULL,
        [TIENE_E_CONV_REC] [smallint] NULL,
        [TIENE_E_CX] [smallint] NULL,
        [TIENE_E_FACT] [smallint] NULL,
        [TIENE_E_FCI] [smallint] NULL,
        [TIENE_E_IB] [smallint] NULL,
        [TIENE_E_LIQ_COM] [smallint] NULL,
        [TIENE_E_PF] [smallint] NULL,
        [TIENE_E_PR_CO] [smallint] NULL,
        [TIENE_E_PR_DOC] [smallint] NULL,
        [TIENE_E_SE] [smallint] NULL,
        [TIENE_E_TC_AGRO] [smallint] NULL,
        [TIENE_E_TC_CORPO] [smallint] NULL,
        [TIENE_E_TC_FLOTA] [smallint] NULL,
        [SALDO_COMPUTO_SIST_2] [numeric](18, 2) NULL,
        [SALDO_COMPUTO_SIST_CC_MB] [numeric](18, 2) NULL,
        [SALDO_COMPUTO_SIST_CA_P] [numeric](18, 2) NULL,
        [SALDO_COMPUTO_SIST_CC_P] [numeric](18, 2) NULL,
        [SALDO_COMPUTO_SIST_FCI] [numeric](18, 2) NULL,
        [CROSS_EMPR] [smallint] NULL,
        [CROSS_IND] [smallint] NULL
        PRIMARY KEY ([PERIODO], [ID_USER])
    ) ON [PRIMARY]
GO
INSERT INTO
    [master].[dbo].[CROSSELLING] (
        [PERIODO],
        [ID_USER],
        [RELACION],
        [TIPOIMPN],
        [NATUJURI],
        [SUCURSAL],
        [BCRASECT],
        [BCRASEGO],
        [GRUPO_CLIENTE],
        [GRUPOGENERAL],
        [SUBGRUPO],
        [SEGMENTO_SUELDOS],
        [SEGMENTO_BANCAS],
        [FUM],
        [ES_CLIENTE],
        [ES_CAPITA],
        [CL_ACTIVO_FUM],
        [TIENE_I_CA_D],
        [TIENE_I_CA_P],
        [TIENE_I_CBESA],
        [TIENE_I_CC],
        [TIENE_I_CCAD],
        [TIENE_I_CS],
        [TIENE_I_FCI],
        [TIENE_I_PF],
        [TIENE_I_PR_HIP],
        [TIENE_I_PR_PERS],
        [TIENE_I_PREP],
        [TIENE_I_SE_PATR],
        [TIENE_I_SEG_VIDA],
        [TIENE_I_VISA],
        [TIENE_I_TJ_SOC],
        [TIENE_E_AC_CC],
        [TIENE_E_CC],
        [TIENE_E_CONV_AH],
        [TIENE_E_CONV_COMALI],
        [TIENE_E_CONV_PP],
        [TIENE_E_CONV_REC],
        [TIENE_E_CX],
        [TIENE_E_FACT],
        [TIENE_E_FCI],
        [TIENE_E_IB],
        [TIENE_E_LIQ_COM],
        [TIENE_E_PF],
        [TIENE_E_PR_CO],
        [TIENE_E_PR_DOC],
        [TIENE_E_SE],
        [TIENE_E_TC_AGRO],
        [TIENE_E_TC_CORPO],
        [TIENE_E_TC_FLOTA],
        [SALDO_COMPUTO_SIST_2],
        [SALDO_COMPUTO_SIST_CC_MB],
        [SALDO_COMPUTO_SIST_CA_P],
        [SALDO_COMPUTO_SIST_CC_P],
        [SALDO_COMPUTO_SIST_FCI],
        [CROSS_EMPR],
        [CROSS_IND]
    )
SELECT
    [PERIODO],
    [ID_USER],
    [RELACION],
    [TIPOIMPN],
    [NATUJURI],
    [SUCURSAL],
    [BCRASECT],
    [BCRASEGO],
    [GRUPO_CLIENTE],
    [GRUPOGENERAL],
    [SUBGRUPO],
    [SEGMENTO_SUELDOS],
    [SEGMENTO_BANCAS],
    TRY_CONVERT(DATE, [FUM], 112) AS [FUM],
    IIF([ES_CLIENTE] = 'SI', 1, 0) AS [ES_CLIENTE],
    [ES_CAPITA],
    IIF([CL_ACTIVO_FUM] = 'SI', 1, 0) AS [CL_ACTIVO_FUM],
    [TIENE_I_CA_D],
    [TIENE_I_CA_P],
    [TIENE_I_CBESA],
    [TIENE_I_CC],
    [TIENE_I_CCAD],
    [TIENE_I_CS],
    [TIENE_I_FCI],
    [TIENE_I_PF],
    [TIENE_I_PR_HIP],
    [TIENE_I_PR_PERS],
    [TIENE_I_PREP],
    [TIENE_I_SE_PATR],
    [TIENE_I_SEG_VIDA],
    [TIENE_I_VISA],
    [TIENE_I_TJ_SOC],
    [TIENE_E_AC_CC],
    [TIENE_E_CC],
    [TIENE_E_CONV_AH],
    [TIENE_E_CONV_COMALI],
    [TIENE_E_CONV_PP],
    [TIENE_E_CONV_REC],
    [TIENE_E_CX],
    [TIENE_E_FACT],
    [TIENE_E_FCI],
    [TIENE_E_IB],
    [TIENE_E_LIQ_COM],
    [TIENE_E_PF],
    [TIENE_E_PR_CO],
    [TIENE_E_PR_DOC],
    [TIENE_E_SE],
    [TIENE_E_TC_AGRO],
    [TIENE_E_TC_CORPO],
    [TIENE_E_TC_FLOTA],
    CAST(
        REPLACE([SALDO_COMPUTO_SIST_2], ',', '.') AS NUMERIC(18, 2)
    ) AS [SALDO_COMPUTO_SIST_2],
    CAST(
        REPLACE([SALDO_COMPUTO_SIST_CC_MB], ',', '.') AS NUMERIC(18, 2)
    ) AS [SALDO_COMPUTO_SIST_CC_MB],
    CAST(
        REPLACE([SALDO_COMPUTO_SIST_CA_P], ',', '.') AS NUMERIC(18, 2)
    ) AS [SALDO_COMPUTO_SIST_CA_P],
    CAST(
        REPLACE([SALDO_COMPUTO_SIST_CC_P], ',', '.') AS NUMERIC(18, 2)
    ) AS [SALDO_COMPUTO_SIST_CC_P],
    CAST(
        REPLACE([SALDO_COMPUTO_SIST_FCI], ',', '.') AS NUMERIC(18, 2)
    ) AS [SALDO_COMPUTO_SIST_FCI],
    [CROSS_EMPR],
    [CROSS_IND]
FROM
    [master].[dbo].[Import_CROSSELLING]
    INNER JOIN [master].[dbo].[USERS] ON [master].[dbo].[USERS].[DOCUMENTO] = [master].[dbo].[Import_CROSSELLING].[CUITCLIE]
GO